---
import "../styles/global.css";
import "leaflet/dist/leaflet.css";
import SidebarMenu from "../components/SidebarMenu.astro";
// import Login from "../pages/login.astro";
const { title, description, showGrid = true, showFooter = true } = Astro.props;
---

<!doctype html>
<html lang="es" class="lg:overflow-y-auto">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width" />
    <link rel="icon" type="image/svg+xml" href="/Ambicon.svg" />
    <meta name="description" content={description} />
    <title>{title}</title>
    <script>
      document.addEventListener("DOMContentLoaded", () => {
        const gridItems = document.querySelectorAll(".grid-item");
        const observer = new IntersectionObserver(
          (entries) => {
            entries.forEach((entry) => {
              if (entry.isIntersecting) {
                entry.target.classList.add("animate-fadeInUp");
                entry.target.classList.remove("opacity-0");
              } else {
                // Reset only the animation state, not the visibility
                entry.target.classList.remove("animate-fadeInUp");
                entry.target.classList.add("opacity-0");
              }
            });
          },
          {
            threshold: 0.1,
            rootMargin: "0px 0px -50px 0px",
          }
        );

        gridItems.forEach((item) => {
          item.classList.add("opacity-0");
          observer.observe(item);
        });
      });
    </script>
  </head>
</html>
<body class="relative">
  {showGrid && <div class="cuadricula"></div>}
  <div class="cursor-punto"></div>
  <!-- <Login /> -->
  <header class="w-full h-header-container absolute z-30">
    <div class="px-11 h-full flex items-center justify-between">
      <div class="flex gap-5 items-center">
        <button
          id="aside--open"
          class="cursor-pointer lg:hidden"
          aria-label="menu"
        >
          <svg
            xmlns="http://www.w3.org/2000/svg"
            height="24px"
            viewBox="0 -960 960 960"
            width="24px"
            fill="currentcolor"
            ><path
              d="M120-240v-80h720v80H120Zm0-200v-80h720v80H120Zm0-200v-80h720v80H120Z"
            ></path></svg
          >
        </button>
        <a
          href="/"
          class="text-2xl font-bold"
          aria-label="ambitrack"
          title="ir al inicio">Ambi<span class="text-green-500">Track</span></a
        >
      </div>
      <div class="hidden lg:block">
        <SidebarMenu />
      </div>
    </div>
  </header>
  <div class="flex w-full relative">
    <div class="flex-1">
      <main id="main-hidden" class="">
        <slot />
      </main>
      {showFooter && <footer class="flex items-center justify-center mb-6 mt-28">
        <div class="flex items-center gap-6">
          <a
            href=""
            target="_blank"
            class="hover:scale-125"
            aria-label="instagram"
            title="Instagram"
          >
            <svg
              width="48"
              height="48"
              fill="none"
              viewBox="0 0 48 48"
              role="img"
              aria-label="Logotipo de Instagram"
            >
              <path
                fill="currentColor"
                d="M24.016 9.242c4.8 0 5.392.03 7.262.093 1.745.094 2.712.374 3.335.623.842.312 1.434.717 2.057 1.34.623.624 1.029 1.216 1.34 2.058.25.623.53 1.59.624 3.335.093 1.901.093 2.462.093 7.262 0 4.8-.03 5.393-.093 7.263-.094 1.745-.374 2.711-.624 3.335-.311.841-.716 1.433-1.34 2.057-.623.623-1.215 1.028-2.057 1.34-.623.25-1.59.53-3.335.623-1.901.094-2.462.094-7.262.094-4.8 0-5.393-.031-7.263-.094-1.745-.093-2.711-.374-3.335-.623-.841-.312-1.434-.717-2.057-1.34-.623-.624-1.029-1.216-1.34-2.057-.25-.624-.53-1.59-.624-3.335-.093-1.902-.093-2.463-.093-7.263s.031-5.392.093-7.262c.094-1.745.374-2.712.624-3.335.311-.842.717-1.434 1.34-2.057.623-.624 1.216-1.029 2.057-1.34.624-.25 1.59-.53 3.335-.624 1.87-.062 2.463-.093 7.263-.093Zm0-3.242c-4.894 0-5.517.031-7.419.094-1.9.093-3.21.405-4.363.841a8.936 8.936 0 0 0-3.18 2.088 8.629 8.629 0 0 0-2.119 3.18c-.436 1.153-.748 2.462-.841 4.363C6.03 18.5 6 19.122 6 24.016c0 4.893.031 5.517.094 7.418.093 1.901.405 3.21.841 4.363a8.936 8.936 0 0 0 2.088 3.18 8.936 8.936 0 0 0 3.18 2.088c1.153.436 2.462.748 4.363.842C18.5 42 19.091 42 23.984 42c4.894 0 5.517-.031 7.419-.093 1.9-.094 3.21-.406 4.363-.842a8.936 8.936 0 0 0 3.18-2.088 8.938 8.938 0 0 0 2.088-3.18c.436-1.153.748-2.462.841-4.363.094-1.933.094-2.525.094-7.418 0-4.894-.031-5.517-.094-7.419-.093-1.9-.405-3.21-.841-4.363a8.937 8.937 0 0 0-2.088-3.18 8.936 8.936 0 0 0-3.18-2.088c-1.153-.436-2.462-.748-4.363-.841C29.5 6.03 28.909 6 24.016 6Z"
              ></path><path
                fill="currentColor"
                d="M24.015 14.758a9.258 9.258 0 0 0 0 18.515 9.258 9.258 0 0 0 0-18.515Zm0 15.242A6.02 6.02 0 0 1 18 23.984a6.02 6.02 0 0 1 6.015-6.015c3.335 0 5.985 2.711 5.985 6.046A5.986 5.986 0 0 1 24.015 30ZM33.615 16.535a2.15 2.15 0 1 0 0-4.301 2.15 2.15 0 0 0 0 4.3Z"
              ></path></svg
            >
          </a>
          <a
            href="https://github.com/munozoscarr/creating-ambitrack-project"
            target="_blank"
            class="hover:scale-125"
            aria-label="githun"
            title="Github"
          >
            <svg
              width="38"
              height="38"
              viewBox="0 0 100 100"
              role="img"
              aria-label="Logotipo de Github"
            >
              <path
                fill="currentColor"
                d="M48.854 0C21.839 0 0 22 0 49.217c0 21.756 13.993 40.172 33.405 46.69 2.427.49 3.316-1.059 3.316-2.362 0-1.141-.08-5.052-.08-9.127-13.59 2.934-16.42-5.867-16.42-5.867-2.184-5.704-5.42-7.17-5.42-7.17-4.448-3.015.324-3.015.324-3.015 4.934.326 7.523 5.052 7.523 5.052 4.367 7.496 11.404 5.378 14.235 4.074.404-3.178 1.699-5.378 3.074-6.6-10.839-1.141-22.243-5.378-22.243-24.283 0-5.378 1.94-9.778 5.014-13.2-.485-1.222-2.184-6.275.486-13.038 0 0 4.125-1.304 13.426 5.052a46.97 46.97 0 0 1 12.214-1.63c4.125 0 8.33.571 12.213 1.63 9.302-6.356 13.427-5.052 13.427-5.052 2.67 6.763.97 11.816.485 13.038 3.155 3.422 5.015 7.822 5.015 13.2 0 18.905-11.404 23.06-22.324 24.283 1.78 1.548 3.316 4.481 3.316 9.126 0 6.6-.08 11.897-.08 13.526 0 1.304.89 2.853 3.316 2.364 19.412-6.52 33.405-24.935 33.405-46.691C97.707 22 75.788 0 48.854 0z"
              ></path></svg
            >
          </a>
          <a
            href=""
            target="_blank"
            class="hover:scale-125"
            aria-label="twitter"
            title="Twitter"
          >
            <svg
              width="35px"
              height="48px"
              viewBox="0 0 35 32"
              role="img"
              aria-label="Logotipo de X"
            >
              <g>
                <path
                  style=" stroke:none;fill-rule:nonzero;fill:currentColor;fill-opacity:1;"
                  d="M 27.535156 0 L 32.898438 0 L 21.117188 13.578125 L 34.882812 32 L 24.078125 32 L 15.621094 20.804688 L 5.9375 32 L 0.570312 32 L 13.054688 17.476562 L -0.128906 0 L 10.941406 0 L 18.585938 10.226562 Z M 25.65625 28.8125 L 28.628906 28.8125 L 9.378906 3.070312 L 6.183594 3.070312 Z M 25.65625 28.8125 "
                ></path></g
              ></svg
            >
          </a>
        </div>
      </footer>
        <p id="p-hidden" class="my-3.5 text-center text-[0.8rem] text-white/60">
          &copy; 2025 Ambitrack
        </p>
      </footer>}
  </div>
  <div
    id="aside-container-mb"
    class="w-aside-container fixed left-0 bottom-0 top-0 h-screen bg-background-light z-50 dark:bg-background-dark lg:hidden -translate-x-full"
  >
    <div class="h-header-container pl-5 flex items-center gap-5">
      <button id="aside--close" class="cursor-pointer">
        <svg
          xmlns="http://www.w3.org/2000/svg"
          height="24px"
          viewBox="0 -960 960 960"
          width="24px"
          fill="#e3e3e3"
          ><path
            d="m256-200-56-56 224-224-224-224 56-56 224 224 224-224 56 56-224 224 224 224-56 56-224-224-224 224Z"
          ></path></svg
        >
      </button>
      <a href="/" class="text-2xl font-bold" aria-label="ambitrack"
        >Ambi<span class="text-green-500">Track</span></a
      >
    </div>
    <SidebarMenu />
  </div>
  <button
    title="ir a riba"
    class="fixed bottom-7 right-7 z-50 cursor-pointer bg-[rgba(0,0,0,0.73)] rounded-full p-4 translate-y-96 rotate-45 backdrop-blur-3xl hover:rotate-0 transition-all duration-300 ease-linear"
    id="button-top"
  >
    <svg
      xmlns="http://www.w3.org/2000/svg"
      height="30px"
      viewBox="0 -960 960 960"
      width="30px"
      fill="#e3e3e3"
      ><path
        d="M440-160v-487L216-423l-56-57 320-320 320 320-56 57-224-224v487h-80Z"
      ></path></svg
    >
  </button>
</body>

<script>
  window.addEventListener("scroll", () => {
    const button_top = document.getElementById(
      "button-top"
    ) as HTMLButtonElement;
    const scroll_top = window.scrollY;

    if (scroll_top > 30) {
      button_top.classList.remove("translate-y-96");
    } else {
      button_top.classList.add("translate-y-96");
    }
  });
  const button_top = document.getElementById("button-top") as HTMLButtonElement;
  button_top.addEventListener("click", () => {
    window.scrollTo({ top: 0, behavior: "smooth" });
  });
  const punto = document.querySelector(".cursor-punto") as HTMLDivElement;
  document.addEventListener("mousemove", (e) => {
    if (!punto) return;
    const x = e.clientX - 100; // 6 = mitad de 12px
    const y = e.clientY - 100;
    punto.style.transform = `translate(${x}px, ${y}px)`;
    punto.style.display = "block";
  });
  const currentUrl: string = window.location.href;
  const links: NodeListOf<HTMLAnchorElement> =
    document.querySelectorAll(".actual");
  links.forEach((link: HTMLAnchorElement) => {
    if (link.href === currentUrl) {
      link.classList.add("active");
    }
  });
  window.addEventListener("DOMContentLoaded", () => {
    const aside_container_mb = document.getElementById("aside-container-mb");
    const aside_open = document.getElementById("aside--open");
    const aside_close = document.getElementById("aside--close");
    const html = document.documentElement;
    if (!aside_container_mb || !aside_open || !aside_close) return;
    aside_open.addEventListener("click", (e) => {
      e.stopPropagation();
      aside_container_mb.classList.add("translate-x-0");
      html.classList.add("pr-[9px]", "overflow-y-hidden"); // Añade padding a <html>
    });
    aside_close?.addEventListener("click", (e) => {
      e.stopPropagation();
      aside_container_mb.classList.remove("translate-x-0");
      html.classList.remove("pr-[9px]", "overflow-y-hidden"); // Quita padding de <html>
    });
    document.addEventListener("click", (event) => {
      const target = event.target;
      if (
        aside_container_mb.classList.contains("translate-x-0") &&
        target instanceof Element &&
        !aside_container_mb.contains(target) &&
        !aside_open.contains(target)
      ) {
        aside_container_mb.classList.remove("translate-x-0");
        html.classList.remove("pr-[9px]", "overflow-y-hidden"); // Quita padding de <html>
      }
    });
  });
</script>
<style>
  footer a {
    transition: all 100ms ease;
  }
</style>
