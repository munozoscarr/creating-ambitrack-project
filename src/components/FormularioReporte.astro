<div class=" grid-item bg-background-dark rounded-4xl relative  p-7 w-full shadow max-w-[500px] mb-4">
  <video src="/videos/4542-179384324.mp4" class="w-full blur-3xl h-full rounded-4xl absolute inset-0 -z-10 object-cover" autoplay loop muted playsinline ></video>

  <div class="w-full h-full absolute inset-0 bg-background-dark -z-[6] rounded-4xl" ></div>
  <form id="formulario-reporte" class="flex gap-8 flex-col w-full">

    <label class="flex flex-col gap-4 mb-2">
      <h2 class="text-black dark:text-white font-boldmidudev text-center">Tipo de incidente:</h2>
      <input type="text" id="tipo" class="bg-white dark:bg-gray-800 text-black dark:text-white border border-gray-300 dark:border-gray-600 p-2 w-full rounded" required />
    </label>
    <label class="flex flex-col gap-4 mb-2">
      <h2 class="text-black dark:text-white font-boldmidudev text-center">Zona:</h2>
      <input type="text" id="zona" class="bg-white dark:bg-gray-800 text-black dark:text-white border border-gray-300 dark:border-gray-600 p-2 w-full rounded" required />
    </label>
    <label class="flex flex-col gap-4 mb-2">
      <h2 class="text-black dark:text-white font-boldmidudev text-center">Descripción:</h2>
      <textarea id="descripcion" class="bg-white dark:bg-gray-800 text-black dark:text-white border border-gray-300 dark:border-gray-600 p-2 w-full rounded" required></textarea>
    </label>
    <button type="submit" class="bg-green-600 text-white px-4 py-2 rounded hover:bg-green-700">
      Guardar reporte
    </button>
  </form>
</div>
<script type="module">
  window.addEventListener('DOMContentLoaded', () => {
    let reportes = JSON.parse(localStorage.getItem('reportes') || '[]');
    let editIndex = null;
    const form = document.getElementById('formulario-reporte');
    const tipo = document.getElementById('tipo');
    const zona = document.getElementById('zona');
    const descripcion = document.getElementById('descripcion');

    function guardarReporte(reporte) {
      reportes.push(reporte);
    }
    function guardarEnLocalStorage() {
      localStorage.setItem('reportes', JSON.stringify(reportes));
      window.dispatchEvent(new Event('storage')); // Para actualizar ListaReportes
    }

    form.addEventListener('submit', (e) => {
      e.preventDefault();
      const nuevoReporte = {
        tipo: tipo.value.trim(),
        zona: zona.value.trim(),
        descripcion: descripcion.value.trim(),
        estado: "En revisión"
      };
      if (editIndex !== null) {
        reportes[editIndex] = nuevoReporte;
        editIndex = null;
      } else {
        guardarReporte(nuevoReporte);
      }
      guardarEnLocalStorage();
      // Limpiar campos
      tipo.value = "";
      zona.value = "";
      descripcion.value = "";
    });

    // Escuchar evento personalizado para editar desde ListaReportes
    window.addEventListener('editar-reporte', (e) => {
      const index = e.detail;
      const r = reportes[index];
      tipo.value = r.tipo;
      zona.value = r.zona;
      descripcion.value = r.descripcion;
      editIndex = index;
    });
  });
</script>